function tp_get_target_by_class(e,t){let o=e.target;if(!o.classList.contains(t)){if(!o.closest("."+t))return!1;o=o.closest("."+t)}return o}function tp_delegate(e,t,o,n){e.addEventListener(t,(e=>{if(!tp_get_target_by_class(e,o))return!1;n(e)}))}function tp_get_offset_top(e){let t=e.offsetTop,o=e;for(;o.offsetParent&&o.offsetParent!=document.body;)o=o.offsetParent,t+=o.offsetTop;return t}function tp_scroll_to(e,t=0){let o=document.querySelector("body > header"),n=tp_get_offset_top(e);n-=0+t,o&&(n-=o.offsetHeight),window.scrollTo({top:n,behavior:"smooth"})}function tp_scroll_tp_hash_target(e){if(e.classList.contains("pillars-popup__btn")||e.classList.contains("pillars-popup__close"))return"";let t=e.closest(".tabs__container"),o=0,n=document.createElement("div");t?(t.querySelectorAll("a.tab-item").forEach((e=>{e.classList.remove("active")})),e.classList.add("active"),o=t.clientHeight,n=t.parentElement):n=e.parentElement;const l=e.getAttribute("href").replace("#","");document.getElementById(l)?tp_scroll_to(document.getElementById(l),o):""==l&&tp_scroll_to(n)}function tp_do_ajax(e){var t=new XMLHttpRequest;"GET"==e.method&&(e.url+="?"+e.data,e.data=null),t.open(e.method,e.url),"object"!=typeof e.data&&t.setRequestHeader("Content-Type",e.contentType),null!=e.dataType&&t.setRequestHeader("Data-Type",e.contentType),t.onerror=function(){console.warn("ajax request error")},null!=e.log&&(t.onprogress=function(e){e.lengthComputable?console.log(`Получено ${e.loaded} из ${e.total} байт`):console.log(`Получено ${e.loaded} байт`)}),t.onreadystatechange=function(){t.readyState,4==t.readyState&&(200==t.status?e.success(t.response):console.warn(`Ошибка ${t.status}: ${t.statusText}`))},t.send(e.data)}function tp_slide_toggle(e,t=.2){if(e.classList.contains("slide-toggle"))return!1;e.classList.add("slide-toggle");let o=window.getComputedStyle(e),n=o.marginTop||"0px",l=o.marginBottom||"0px",a=!0;const r=1e3*t;let c=0,s=Math.round(r/10);"none"==e.style.display?(a=!1,e.style.removeProperty("display"),e.style.height="0px"):e.style.overflow="hidden";let i=setInterval((function(){if(c>=s)return a?(e.style.marginTop=n,e.style.marginBottom=l,e.style.display="none"):(e.style.removeProperty("overflow"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom")),e.style.removeProperty("height"),e.classList.remove("slide-toggle"),clearInterval(i),!0;c++,a?(e.style.marginTop=parseInt(n)*(1-c/s)+"px",e.style.marginBottom=parseInt(l)*(1-c/s)+"px",e.style.height=e.scrollHeight*(1-c/s)+"px"):(e.style.marginTop=parseInt(n)*(c/s)+"px",e.style.marginBottom=parseInt(l)*(c/s)+"px",e.style.height=e.scrollHeight*(c/s)+"px")}),10)}function tp_pageloader_item(e){const t=e.parentElement;if(t.classList.contains("pageloader__item"))t.querySelector(".pageloader__container").remove(),t.classList.remove("pageloader__item");else{let e=document.createElement("div");e.classList.add("pageloader__container"),e.innerHTML='<div class="pageloader"></div>',t.prepend(e),t.classList.add("pageloader__item")}}function tp_slide_toggle_animate(e,t=.1,o=null,n=null){if(e.classList.contains("slide-toggle"))return!1;let l;e.classList.add("slide-toggle"),window.innerWidth<window.wp_theplugin.break_sm&&(t/=2);let a=window.getComputedStyle(e),r=a.marginTop||"0px",c=a.marginBottom||"0px",s=!0;const i=1e3*t;let p=0,d=Math.round(i/10);e.style.overflow="hidden",null==o?"none"==e.style.display&&(s=!1,e.style.removeProperty("display"),e.style.height="0px"):s=o,l&&cancelAnimationFrame(l),l=requestAnimationFrame((function t(){if(!(p<d))return s?(e.style.marginTop=r,e.style.marginBottom=c,e.style.display="none"):(e.style.removeProperty("overflow"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom")),e.style.removeProperty("height"),e.classList.remove("slide-toggle"),l&&(cancelAnimationFrame(l),n&&"function"==typeof n&&n()),!0;p++,s?(e.style.marginTop=parseInt(r)*(1-p/d)+"px",e.style.marginBottom=parseInt(c)*(1-p/d)+"px",e.style.height=e.scrollHeight*(1-p/d)+"px"):(e.style.marginTop=parseInt(r)*(p/d)+"px",e.style.marginBottom=parseInt(c)*(p/d)+"px",e.style.height=e.scrollHeight*(p/d)+"px"),l=requestAnimationFrame(t)}))}function is_menu_item_childrens_show(e,t){const o=t.parentElement;window.innerWidth<window.wp_theplugin.break_sm?(e.preventDefault(),o.classList.contains("active")?o.classList.remove("active"):o.classList.add("active")):o.classList.remove("active")}document.addEventListener("click",(function(e){let t=e.target;"a"!=t.tagName.toLowerCase()&&(t=t.closest("a")),t&&"a"==t.tagName.toLowerCase()&&t.getAttribute("href")&&-1!=t.getAttribute("href").indexOf("#")&&(console.log("#",t,window.innerWidth,window.wp_data.break_sm),window.wp_data.break_sm>=window.innerWidth&&(e.preventDefault(),tp_scroll_tp_hash_target(t)))})),tp_delegate(document.body,"click","tp-target-toggle",(function(e){e.preventDefault();let t=e.target.getAttribute("href").replace("#","");tp_slide_toggle_animate(document.getElementById(t))}));const main_menu=document.getElementById("main_menu");if(main_menu){const e=document.querySelector('.navbar-toggle[data-target="#main_menu"]');e&&(e.addEventListener("click",(function(t){t.preventDefault();if(main_menu.style.zIndex=11,document.querySelector("body > header").style.zIndex=11,main_menu.querySelectorAll(".d-sm-block").forEach((e=>{e.classList.remove("d-sm-block")})),e.classList.contains("collapse"))main_menu.style.left="-120vw",e.classList.remove("collapse"),document.querySelector("body").classList.remove("menu-collapse"),document.querySelector("body > header").removeAttribute("style");else{document.querySelector("body").classList.add("menu-collapse");let t=parseInt(document.querySelector("body > header").outerHeight);main_menu.style.top=t+"px",main_menu.style.left="0px",main_menu.style.height="calc(100vh - "+t+"px)",e.classList.add("collapse")}})),window.addEventListener("resize",(function(e){window.innerWidth>=window.wp_theplugin.break_sm&&main_menu.removeAttribute("style")})));const t=main_menu.querySelectorAll("ul.navbar-nav > li.menu-item-has-children > a");if(t.length)for(let n=0;n<t.length;n++){t[n].addEventListener("click",(function(e){is_menu_item_childrens_show(e,this)}))}const o=main_menu.querySelectorAll('ul.sub-class > li[class^="product_group-"] > span');if(o.length)for(let l=0;l<o.length;l++){o[l].addEventListener("click",(function(e){is_menu_item_childrens_show(e,this)}))}}const menu_video_links=document.querySelectorAll(".menu-item-3462");if(menu_video_links.length)for(let a=0;a<menu_video_links.length;a++){const r=menu_video_links[a];r.querySelector("a").setAttribute("target","_blank"),r.querySelector("a").setAttribute("rel","nofollow")}function tp_format_price(e){return isNaN(e)?"":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function set_data_params_to_api(e){const t=new URLSearchParams;for(const o of e)t.append(o[0],o[1]);return t}function send_data_to_api(e,t,o,n="GET",l=null){let a={method:n,headers:{"X-WP-Nonce":wp_api_settings.nonce}};t&&(t+="/");let r=wp_api_settings.root+wp_api_settings.namespace+"/"+o+"/"+t;"GET"==n&&(r+="?"+e.toString()),"POST"==n&&(a.body=e),console.log("api url",r),console.log("api params",a);fetch(r,a).then((e=>e.json())).then((function(e){console.log(e),"ok"==e?.status&&(console.log(e.message),"function"==typeof l&&l(e.message),null!=e.message?.redirect&&setTimeout((function(){window.location.href=e.message.redirect}),1e3))})).catch((function(e){console.warn(e)}))}function send_form_data_to_api(e,t,o){e.parentElement;send_data_to_api(set_data_params_to_api(new FormData(e)),t,o,"POST")}function is_show_label(e){const t=this.parentElement;""!=this.value||this.classList.contains("mask-phone")?t.classList.add("active"):t.classList.remove("active")}tp_delegate(document.body,"click","form-style__input",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,"form-style__input");t.parentElement.classList.add("active"),t.addEventListener("blur",is_show_label,{once:!0})})),tp_delegate(document.body,"focusin","form-style__input",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,"form-style__input");t.parentElement.classList.add("active"),t.addEventListener("blur",is_show_label,{once:!0})})),tp_delegate(document.body,"submit","form-ajax",(function(e){e.preventDefault();const t=e.target,o=t.parentElement;let n=new FormData(t);const l=t.id;let a=null,r=t.querySelectorAll('input[type="file"]');if(r.length)for(let e=0;e<r.length;e++){const t=r[e];n.append(t.name,t.files[0])}o.querySelector('.pillars-informer[data-id="'+l+'"]')?a=o.querySelector('.pillars-informer[data-id="'+l+'"]'):(a=document.createElement("div"),a.classList.add("pillars-informer"),a.setAttribute("data-id",l),o.insertBefore(a,t)),t.classList.add("block-loading"),fetch(window.wp_data.ajax_url,{method:"post",body:n}).then((e=>e.json())).then((function(e){if(console.log("response",e),t.classList.remove("block-loading"),null!=e.message&&null!=e.type){switch(e.type){case"ok":case"fail":case"spam":t.remove()}a.innerHTML=e.message}else a.innerHTML=window.wp_theplugin.notice_error})).catch((function(e){console.warn("error",e)}))}));const cookiesection=document.getElementById("agree-cookie");cookiesection&&cookiesection.addEventListener("submit",(function(e){e.preventDefault();const t=e.target;let o=new FormData(t);const n=t.closest("section.cookie");t.classList.add("block-loading"),fetch(window.wp_data.ajax_url,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o).toString()}).then((e=>e.json())).then((function(e){if(console.log("cookie",e),t.classList.remove("block-loading"),null!=e.message&&null!=e.type)switch(e.type){case"ok":n.remove();break;case"error":case"fail":case"spam":alert(e.message)}})).catch((function(e){console.warn("cookie-error",e)}))})),$(document).on("click",'form.form-style button[type="submit"]',(function(e){let t=$(this).closest("form");console.log("SEND",$(this),t.serialize()+"&action=pillars_senddata"),$.ajax({type:"post",url:window.wp_theplugin.ajax_url,data:t.serialize()+"&action=pillars_senddata",traditional:!0,success:function(e){console.log("SEND DATA",e)},error:function(e){console.log("ERRORS SEND DATA",e)}})}));const countries=[{name:"Россия",code:7,iso:"ru",alter:"",placeholder:"(912) 345-67-89",mask:"(^^^) ^^^-^^-^^"},{name:"Азербайджан",code:994,iso:"az",alter:"Azərbaycan",placeholder:"40 123 45 67",mask:"^^ ^^^ ^^ ^^"},{name:"Армения",code:374,iso:"am",alter:"Հայաստան",placeholder:"77 123456",mask:"^^ ^^^^^^"},{name:"Беларусь",code:375,iso:"by",alter:"",placeholder:"29 491-19-11",mask:"^^ ^^^-^^-^^"},{name:"Казахстан",code:7,iso:"kz",alter:"Қазақстан",placeholder:"771 000 9998",mask:"^^^ ^^^ ^^^^"},{name:"Кыргызстан",code:996,iso:"kg",alter:"",placeholder:"700 123 456",mask:"^^^ ^^^ ^^^^"},{name:"Молдова",code:373,iso:"md",alter:"",placeholder:"621 12 345",mask:"^^^ ^^ ^^^"},{name:"Таджикистан",code:992,iso:"tj",alter:"Тоҷикистон",placeholder:"917 12 3456",mask:"^^^ ^^ ^^^^"},{name:"Туркменистан",code:993,iso:"tm",alter:"Türkmenistan",placeholder:"66 123456",mask:"^^ ^^^^^^"},{name:"Узбекистан",code:998,iso:"uz",alter:"Oʻzbekiston",placeholder:"91 234 56 78",mask:"^^ ^^^ ^^ ^^"}];function form_phone_init_list_country(e){countries.forEach((t=>{const o=document.createElement("li");o.classList.add("phone-country-code__item"),o.role="option",o.tabindex="-1",o.dataset.dialCode=t.code,o.dataset.countryCode=t.iso,o.ariaSelected=!1,o.innerHTML=`<div class="phone-country-code__flag --${t.iso}"></div><span class="phone-country-code__name">${t.name}</span><span class="phone-country-code__item-dial">+${t.code}</span>`,e.appendChild(o)}));form_phone_set_country(form_phone_get_container(e),countries[0])}function form_phone_set_country(e,t){document.querySelectorAll(".phone-country-code__container .phone-country-code__flag").forEach((o=>{o.parentElement.querySelector(".phone-country-code__dial").textContent="+"+t.code,o.removeAttribute("class"),o.classList.add("phone-country-code__flag","--"+t.iso);const n=form_phone_get_input(o.parentElement);n.dataset.mask="+"+t.code+" "+t.mask,n.setAttribute("placeholder","+"+t.code+" "+t.placeholder),n.style="padding-left: "+(e.offsetWidth-e.querySelector(".phone-country-code__dial").offsetWidth)+"px !important"})),$("input.mask-phone, .mask-phone input").maskPhone()}function form_phone_get_container(e){return e.closest(".phone-country-code").querySelector(".phone-country-code__container")}function form_phone_get_input(e){return e.closest(".phone-country-code").parentElement.querySelector("input.mask-phone")}function tp_get_sections_request(e,t,o=!0,n=null){let l=new FormData;for(let e in t)l.append(e,t[e]);l.append("referer",window.location.href),send_data_to_api(t=set_data_params_to_api(l),"form","get-section","GET",(function(t){if(console.log("success request section"),null!=t.wrapper&&null!=t.type)switch(t.type){case"ok":e.insertAdjacentHTML("beforebegin",t.wrapper),e.remove(),"function"==typeof n&&n(t);break;case"error":case"fail":let l=(new DOMParser).parseFromString(t.message,"text/html").getElementsByTagName("div")[0];e.prepend(l),console.log("notice",t),o&&setTimeout((function(){tp_slide_toggle_animate(e,.1,(function(){e.remove()}))}),3e3)}else e.insertAdjacentHTML("afterbegin",window.wp_theplugin.notice_section)}))}function tp_get_sections(e){if(!e.getAttribute("data-section"))return!1;let t=JSON.parse(e.getAttribute("data-section"));return null!=t.type&&null!=t.part&&tp_get_sections_request(e,t),!1}function tp_clipboard_add_referer_link(){let e=window.getSelection(),t=e+("<br><br>Источник: "+document.location.href),o=document.createElement("div");o.style.position="absolute",o.style.left="-99999px",document.body.appendChild(o),o.innerHTML=t,e.selectAllChildren(o),window.setTimeout((function(){document.body.removeChild(o)}),100)}function tp_disable_context(e){if("IMG"==(null==e?event.srcElement.tagName:e.target.tagName))return!1}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".phone-country-code__list");if(e.length)for(let t=0;t<e.length;t++){const o=e[t];o.innerHTML="",form_phone_init_list_country(o)}})),document.addEventListener("click",(e=>{const t=document.querySelectorAll(".phone-country-code__list:not(.d-none)");if(t.length)for(let o=0;o<t.length;o++){const n=t[o];n.closest(".phone-country-code").contains(e.target)||n.classList.add("d-none")}})),tp_delegate(document.body,"click","phone-country-code__item",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,"phone-country-code__item"),o=t.closest(".phone-country-code__list"),n=form_phone_get_container(o);if(t){const e=t.dataset.countryCode,l=countries.find((t=>t.iso===e));if(l){form_phone_set_country(n,l),form_phone_get_input(n).focus()}o.classList.add("d-none")}})),tp_delegate(document.body,"click","phone-country-code__container",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,"phone-country-code__container"),o=t.closest(".phone-country-code").querySelector(".phone-country-code__list"),n=t.closest(".phone-country-code").parentElement;form_phone_get_input(t.closest(".phone-country-code")).blur(),n.classList.add("active"),o.classList.toggle("d-none")})),document.addEventListener("DOMContentLoaded",(function(e){const t=document.querySelectorAll(".get-sections__placeholder");if(t.length)for(let e=0;e<t.length;e++){tp_get_sections(t[e])}})),tp_delegate(document.body,"click","video-placeholder",(function(e){const t=tp_get_target_by_class(e,"video-placeholder");if(!t.classList.contains("--link")){e.preventDefault();const o=t.getAttribute("href");if(o){const e="video-wrapper",t=!!o.includes("frame=clip");tp_set_popup_wrapper(e);const n=document.getElementById(e);n.querySelector(".video-wrapper")||n.querySelector("."+window.wp_data.popup_key+"__close").insertAdjacentHTML("afterend",'<div class="video-wrapper"></div>');const l=n.querySelector(".video-wrapper");l.classList.add("block-loading"),l.innerHTML='<iframe class="" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" frameborder="0" src="'+o+'"></iframe>';l.querySelector("iframe").addEventListener("load",(function(e){l.classList.remove("block-loading")})),n.querySelector(".pillars-popup__content").classList.add("video-content"),t&&(n.querySelector(".video-content").classList.add("--clip"),n.querySelector(".video-content iframe").setAttribute("allow","autoplay; encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;")),tp_popup_open(n)}}})),document.addEventListener("copy",tp_clipboard_add_referer_link),document.oncontextmenu=tp_disable_context;let mailtolinks=document.querySelectorAll('[href^="mailto:"]:not([class])');if(mailtolinks.length)for(let c=0;c<mailtolinks.length;c++){const s=mailtolinks[c];s.addEventListener("click",(function(e){if(e.preventDefault(),navigator.clipboard){let e=s.getAttribute("href").replace("mailto:","");navigator.clipboard.writeText(e).then((function(){alert("Почта «"+e+"» скопирована в буфер обмена.")}),(function(e){console.error("Произошла ошибка при копировании текста: ",e)}))}}))}const popup_delay=400,popup_body=document.querySelector("body"),popup_key=window.wp_data.popup_key,popup_class="."+popup_key,popup_padding=document.querySelectorAll(popup_class+"__padding");let popup_unlock=!0;function tp_set_popup_wrapper(e){if(!document.getElementById(e)){const t=document.createElement("div");t.setAttribute("id",e),t.classList.add(popup_key),t.innerHTML=window.wp_data.popup_wrapper.replace("#popup_id","#"+e),popup_body.append(t)}}function tp_popup_open(e){if(e&&popup_unlock){const t=document.querySelector(popup_class+".open");t?tp_popup_close(t,!1):tp_body_collapse(),e.classList.add("open"),e.addEventListener("click",(function(e){e.target.closest(popup_class+"__content")||tp_popup_close(e.target.closest(popup_class))}))}}function tp_popup_close(e,t=!0){popup_unlock&&(e.classList.remove("open"),e.querySelector(".video-wrapper > iframe")&&e.querySelector(".video-wrapper > iframe").remove(),t&&tp_body_uncollapse())}function tp_body_collapse(){const e=window.innerWidth-document.querySelector("main").offsetWidth+"px";if(popup_padding.length)for(let t=0;t<popup_padding.length;t++){popup_padding[t].style.paddingRight=e}popup_body.style.paddingRight=e,popup_body.classList.add("collapse"),popup_unlock=!1,setTimeout((function(){popup_unlock=!0}),popup_delay)}function tp_body_uncollapse(){setTimeout((function(){if(popup_padding.length)for(let e=0;e<popup_padding.length;e++){popup_padding[e].style.paddingRight="0px"}popup_body.style.paddingRight="0px",popup_body.classList.remove("collapse")}),popup_delay),popup_unlock=!1,setTimeout((function(){popup_unlock=!0}),popup_delay)}function wp_nonce_update(){const e=document.querySelectorAll('input[name*="_verify_key"]');if(e.length){let t=new FormData;for(let o=0;o<e.length;o++){const n=e[o];console.log("nonce-input",n.name,n.value),t=new FormData,t.append("action","tp_nonce_update"),t.append(n.name,n.value),tp_do_ajax({method:"POST",url:window.wp_theplugin.ajax_url,data:t,contentType:"application/x-www-form-urlencoded",success:function(e){console.log("success wp nonce",e),data=JSON.parse(e),null!=data.result&&""!=data.result&&(n.value=data.result,console.log("nonce-responce",n.name,n.value))}})}}}if(document.addEventListener("keydown",(function(e){if(27===e.which){const e=document.querySelector(popup_class+".open");e&&tp_popup_close(e)}})),tp_delegate(document.body,"click",popup_key+"__btn",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,popup_key+"__btn");let o="";o=t.hasAttribute("data-id")?t.getAttribute("data-id"):t.getAttribute("href").replace("#",""),tp_set_popup_wrapper(o);const n=document.getElementById(o);if(t.hasAttribute("data-form")){if(!document.getElementById(t.getAttribute("data-form"))){n.querySelector(".get-form")||n.querySelector(popup_class+"__close").insertAdjacentHTML("afterend",'<div class="get-form"></div>');const e=n.querySelector(".get-form");e.innerHTML="",e.classList.add("block-loading");let o=t.getAttribute("data-form_args")??null;tp_get_sections_request(e,{type:"form",part:t.getAttribute("data-form"),path:"theme",args:o},!1,(function(e){if(null!=e.params.part){console.log("sections-request",e.params.part);let t=e.params.part;$("#"+t).find("input.mask-phone").maskPhone(),$("#"+t).find("input.mask-date").maskDate();const o=document.getElementById(t).querySelector(".phone-country-code");if(o){const e=o.querySelector(".phone-country-code__list");e.innerHTML="",form_phone_init_list_country(e)}}}))}wp_nonce_update()}tp_popup_open(n)})),tp_delegate(document.body,"click",popup_key+"__close",(function(e){e.preventDefault();tp_popup_close(e.target.closest(popup_class))})),document.addEventListener("DOMContentLoaded",wp_nonce_update),window.onblur=function(){wp_nonce_update()},document.querySelector(".btn-up")){({el:document.querySelector(".btn-up"),show(){this.el.classList.remove("btn-up__hide")},hide(){this.el.classList.add("btn-up__hide")},addEventListener(){window.addEventListener("scroll",(()=>{(window.scrollY||document.documentElement.scrollTop)>document.documentElement.clientHeight-200?this.show():this.hide()})),document.querySelector(".btn-up").onclick=()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})}}}).addEventListener()}tp_delegate(document.body,"change","input-file",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,"input-file"),o=t.closest(".file-wrapper");if(1==t.files.length){let e=t.files[0],n=["pdf","doc","docx","xls","xlsx","txt"],l=8388608,a=[],r=o.querySelector(".input-message"),c=e.name.split(".").pop().toLowerCase();console.log("file",e,c,n,n.indexOf(c),e.size>0,e.size<=l),t.classList.remove("--invalid"),r.removeAttribute("data-invalid"),e.size?e.size>l&&a.push("файл не должен превышать "+parseInt(l/1024/1024)+" Мб"):a.push("файл должен иметь размер"),n.length&&-1===n.indexOf(c)&&a.push("выберете файл следующих форматов: "+n.join(", ")),console.log("error",a.length,a),a.length?(t.value="",t.classList.add("--invalid"),r.setAttribute("data-invalid",a.join(", ")),o.querySelector(".input-file-text").innerHTML=t.getAttribute("placeholder")):o.querySelector(".input-file-text").innerHTML=e.name+'<span class="input-file-text__remove" aria-label="Удалить этот файл"></span>'}})),tp_delegate(document.body,"click","input-file-text__remove",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,"input-file-text__remove").closest(".file-wrapper");if(t.querySelector(".input-file")){const e=t.querySelector(".input-file");e.value="",t.querySelector(".input-file-text").innerHTML=e.getAttribute("placeholder")}})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".woocommerce-loop-product__link .cover");if(e.length){const t=Array.from(e),o=4,n=[];for(let e=0;e<t.length;e+=o)n.push(t.slice(e,e+o));n.forEach(((e,t)=>{setTimeout((()=>{const t=Math.floor(Math.random()*e.length),o=e[t];o.closest(".cover").classList.add("--animate");o.querySelector(".hover-light[data-image]")&&o.insertAdjacentHTML("beforeEnd",o.querySelector(".hover-light[data-image]").getAttribute("data-image"))}),3e3*t)}))}})),document.addEventListener("DOMContentLoaded",(function(e){let t="";window.wp_data.currencysymbol?t=window.wp_data.currencysymbol:document.querySelector(".woocommerce-Price-currencySymbol")&&(t=document.querySelector(".woocommerce-Price-currencySymbol").innerHTML),console.log("currencySymbol",t);let o=document.querySelectorAll('select[name^="attribute_pa_"]');if(o.length)for(let e=0;e<o.length;e++){const t=o[e];let n=t.querySelectorAll("option[data-description]");if(n.length){const e=t.closest("form").querySelector('label[for="'+t.id+'"]');e.classList.add("pillars-tip__label"),e.innerHTML+='<div class="pillars-tip__wrapper"><div class="pillars-tip__icon"></div><div class="pillars-tip__info"></div></div>';const o=e.querySelector(".pillars-tip__info");for(let e=0;e<n.length;e++){const t=n[e];o.innerHTML+="<p>"+t.getAttribute("data-description")+"</p>",console.log(t.text,t.getAttribute("data-description"))}}}function n(e){let o=parseInt(e.getAttribute("data-price")),n=e.querySelector(".woocommerce-variation-price .price");if(o&&t&&n){let l,a,r=n.innerText.replace(/[^\d.,\s]/g,""),c=parseInt(e.querySelector('input[name="quantity"]').value);document.querySelector(".pillars-wc-quantity__discounts.product-id-"+e.querySelector('[name="product_id"]').value)?(l=document.querySelector(".pillars-wc-quantity__discounts.product-id-"+e.querySelector('[name="product_id"]').value).getAttribute("data-product_discounts"),l=JSON.parse(l)):l={count:0,per:0};let s=e.querySelectorAll(".pillars-wc-product__price-add");if(s.length)for(let e=0;e<s.length;e++)o+=parseInt(s[e].getAttribute("data-price"));l.count<=c&&0!=l.per&&(a=Math.floor(o*parseInt(l.per)/100),o-=a);let i=tp_format_price(o*c);n.innerHTML=n.innerHTML.replace(r,i),a?(e.querySelector(".woocommerce-variation-price .price-discounts")||n.insertAdjacentHTML("afterEnd",'<span class="price-discounts"></span>'),e.querySelector(".woocommerce-variation-price .price-discounts").innerHTML=tp_format_price(a*c)+t):e.querySelector(".woocommerce-variation-price .price-discounts")&&e.querySelector(".woocommerce-variation-price .price-discounts").remove()}}function l(e){let t=e.querySelector('[name="update_cart"]');t.removeAttribute("disabled"),t.setAttribute("aria-disabled",!1),t.dispatchEvent(new CustomEvent("click",{bubbles:!0})),console.log("update",t),$('[name="update_cart"]').trigger("click")}function a(e,o=!0){let l="",a="",r="";const c=e.getElementsByTagName("option");if(e.parentElement.querySelector('.pillars-select[data-id="'+e.id+'"]')||(l=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),a.className="pillars-select__toggle",l.append(a),r.className="pillars-select__dropdown",l.append(r),l.className="pillars-select",l.setAttribute("data-id",e.id),e.after(l),e.classList.add("visuallyhidden")),l=e.parentElement.querySelector('.pillars-select[data-id="'+e.id+'"]'),l.querySelector(".pillars-select__toggle").innerHTML="",r=l.querySelector(".pillars-select__dropdown"),r.innerHTML="",c.length){let t=document.createElement("div");t.className="pillars-select__options",t.innerHTML="",r.append(t),t=r.querySelector(".pillars-select__options");for(let o=0;o<c.length;o++){const n=c[o];let a=document.createElement("div");if(a.className="pillars-select__option",a.innerHTML=n.innerHTML,a.setAttribute("value",n.getAttribute("value")),n.hasAttribute("data-color")&&a.insertAdjacentHTML("afterBegin",'<span class="pillars-select__option-color" style="background:'+n.getAttribute("data-color")+';"></span>'),n.hasAttribute("data-price")){let e=JSON.parse(n.getAttribute("data-price"));a.insertAdjacentHTML("beforeEnd",'<span class="pillars-select__option-price" data-price="'+e.price+'">+'+e.price_html+"</span>")}if(n.getAttribute("value")==e.value){let e=a.cloneNode(!0);l.querySelector(".pillars-select__toggle").append(e)}t.append(a)}}o&&function(e){let o=e.querySelector(".woocommerce-variation-price"),l=e.querySelector('input[name="variation_id"]'),a=0;if(l){let t=JSON.parse(e.getAttribute("data-product_variations"));for(let e=0;e<t.length;e++)if(t[e].variation_id==l.value){a=t[e].display_price;break}e.setAttribute("data-price",a)}o&&(o.querySelector(".woocommerce-Price-amount")||(o.innerHTML='<span class="price"><span class="woocommerce-Price-amount amount"><bdi>0<span class="woocommerce-Price-currencySymbol">'+t+"</span></bdi></span></span>"),o=o.querySelector(".price"),l||(a=parseInt(o.innerText.replace(/[^\d.,]/g,""))),a&&(e.setAttribute("data-price",a),setTimeout((function(){n(e)}),500)))}(e.closest("form"))}if(tp_delegate(document.body,"click","pillars-wc-product-gallery__image-link",(function(e){const t=tp_get_target_by_class(e,"pillars-wc-product-gallery__image-link");console.log("image-link",t),t.closest(".pillars-wc-product-thumbnails__wrapper")&&(e.preventDefault(),console.log("image-link","prevent"))})),Fancybox.bind("[data-fancybox]",{}),Fancybox.bind('[data-fancybox="usage-gallery"]',{}),tp_delegate(document.body,"click","pillars-wc-quantity__minus",(function(e){const t=tp_get_target_by_class(e,"pillars-wc-quantity__minus").closest(".pillars-wc-quantity__wrapper").querySelector("input.qty");let o=parseInt(t.value);o-=1,o<t.getAttribute("min")&&(o=t.getAttribute("min")),t.value=o;let a=t.closest("form"),r=new CustomEvent("change",{bubbles:!0});t.dispatchEvent(r),a.classList.contains("cart")?n(a):a.querySelector('[name="update_cart"]')&&l(a)})),tp_delegate(document.body,"click","pillars-wc-quantity__plus",(function(e){const t=tp_get_target_by_class(e,"pillars-wc-quantity__plus").closest(".pillars-wc-quantity__wrapper").querySelector("input.qty");let o=parseInt(t.value);o+=1,t.getAttribute("max")&&o>t.getAttribute("max")&&(o=t.getAttribute("max")),t.value=o;let a=t.closest("form"),r=new CustomEvent("change",{bubbles:!0});t.dispatchEvent(r),a.classList.contains("cart")?n(a):a.querySelector('[name="update_cart"]')&&l(a)})),document.querySelector("select#product_siblings")){const e=document.querySelector("select#product_siblings");a(e,!1),e.addEventListener("change",(function(e){e.preventDefault();let t=JSON.parse(this.getAttribute("data-permalinks"));location.replace(t[this.value])}))}if(document.querySelector("select#product_backlight")){const e=document.querySelector("select#product_backlight");a(e,!1),e.addEventListener("change",(function(e){e.preventDefault();let t=JSON.parse(this.getAttribute("data-permalinks"));location.replace(t[this.value])}))}const r=document.querySelectorAll("form.variations_form select");if(r.length){let e=new MutationObserver((e=>{for(let t of e)a(t.target)})),t={attributes:!0,childList:!0,characterData:!0};for(let o=0;o<r.length;o++){const n=r[o],l=n.getElementsByTagName("option");console.log("options",l),e.observe(n,t)}}function c(){const e=new URLSearchParams;e.append("action","pillars_wc_cart_count"),fetch(window.wp_data.ajax_url,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(e).toString()}).then((e=>e.json())).then((function(e){if(console.log("pillars_wc_cart_count",e),null!=e.content&&null!=e.type&&"ok"===e.type)document.getElementById("pillars_wc_cart_contents_count").innerHTML=e.content.count})).catch((function(e){console.warn(e)}))}tp_delegate(document.body,"click","pillars-select__toggle",(function(e){e.preventDefault();!function(e){if(e.classList.contains("active"))e.classList.remove("active");else{const t=document.querySelectorAll(".pillars-select__toggle");if(t.length)for(let e=0;e<t.length;e++)t[e].classList.remove("active");e.classList.add("active")}}(tp_get_target_by_class(e,"pillars-select__toggle"))})),tp_delegate(document.body,"click","pillars-select__option",(function(e){e.preventDefault();const t=tp_get_target_by_class(e,"pillars-select__option");if(!t.closest(".pillars-select__toggle")){const e=t.closest(".pillars-select"),o=document.getElementById(e.getAttribute("data-id"));let n;o.value=t.getAttribute("value"),t.querySelector(".pillars-select__option-price")?e.parentElement.querySelector(".pillars-wc-product__price-add")?(e.parentElement.querySelector(".pillars-wc-product__price-add").innerHTML=t.querySelector(".pillars-select__option-price").innerHTML,e.parentElement.setAttribute("data-price",t.querySelector(".pillars-select__option-price").getAttribute("data-price"))):e.insertAdjacentHTML("afterEnd",'<div class="pillars-wc-product__price-add" data-price="'+t.querySelector(".pillars-select__option-price").getAttribute("data-price")+'">'+t.querySelector(".pillars-select__option-price").innerHTML+"</div>"):e.parentElement.querySelector(".pillars-wc-product__price-add")&&e.parentElement.querySelector(".pillars-wc-product__price-add").remove(),document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent("change",!0,!1),o.dispatchEvent(n)):document.createEventObject&&(n=document.createEventObject(),o.fireEvent("onchange",n)),e.querySelector(".pillars-select__toggle").classList.remove("active")}})),document.addEventListener("mouseup",(function(e){if(!e.target.matches(".pillars-select__toggle.active, .pillars-select__toggle.active *")){const e=document.querySelectorAll(".pillars-select__toggle.active");if(e.length)for(let t=0;t<e.length;t++)e[t].classList.remove("active")}})),window.addEventListener("visibilitychange",(function(){!0!==document.hidden&&c()}),!1),tp_delegate(document.body,"submit","cart",(function(e){e.preventDefault();const t=e.target;let o=new FormData(t);const n="add-to-cart-popup";o.append("action","pillars_add_to_cart"),tp_set_popup_wrapper(n);const l=document.getElementById(n);l.querySelector(".get-form")||l.querySelector("."+window.wp_data.popup_key+"__close").insertAdjacentHTML("afterend",'<div class="get-form"></div>');const a=l.querySelector(".get-form");a.innerHTML="",fetch(window.wp_data.ajax_url,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o).toString()}).then((e=>e.json())).then((function(e){if("ok"==e?.status){console.log(e.message),tp_popup_open(l);const t=e.message;if(null!=t.wrapper&&null!=t.type)switch(t.type){case"ok":a.insertAdjacentHTML("beforeend",t.wrapper),c();break;case"error":case"fail":let e=(new DOMParser).parseFromString(t.message,"text/html").getElementsByTagName("div")[0];a.prepend(e),console.log("notice",t),hide_notice&&setTimeout((function(){tp_slide_toggle_animate(a,.1,(function(){a.remove()}))}),3e3)}else a.insertAdjacentHTML("afterbegin",window.wp_theplugin.notice_section)}})).catch((function(e){console.warn(e)}))}))}));let search_products_term="";function pl_search_product_api(e,t){const o=e.closest("form");let n=e.value;if(n.length>2){o.classList.add("search-active");const e=new URLSearchParams;e.append("t",n),e.append("search_verify_key",document.getElementById("search_verify_key").value),e.append("action","pillars_search_product"),send_data_to_api(e,"","search-product","GET",(function(e){if(console.log("success request search",e),null!=e.status){let n=o.getBoundingClientRect();if(t.style.display="inline-block",t.style.position="absolute",t.style.top=n.top+document.body.scrollTop+o.offsetHeight+"px",t.style.left=n.left+document.body.scrollLeft+"px","ok"===e.status)t.innerHTML="<ul>"+e.wrapper+"</ul>";else null!=e.notice?t.innerHTML=e.notice:t.innerHTML="Ошибка запроса поиска.<br>Пожалуйста, обновите страницу.";o.classList.remove("search-active")}}))}else t.style.display="none",t.innerHTML=""}const search_products_inputs=document.querySelectorAll(".form-search-products__input");if(search_products_inputs.length){const i="pillars-search-products-result";let p=!1;if(!document.getElementById(i)){const h=document.createElement("div");h.setAttribute("id",i),document.body.append(h)}const d=document.getElementById(i);d.style.display="none",d.innerHTML="",d.addEventListener("mouseover",(()=>{p=!0})),d.addEventListener("mouseout",(()=>{p=!1}));for(let v=0;v<search_products_inputs.length;v++){const b=search_products_inputs[v];b.addEventListener("focus",(()=>{pl_search_product_api(b,d)})),b.addEventListener("keyup",(()=>{pl_search_product_api(b,d)})),b.addEventListener("blur",(()=>{p||(b.value="",search_products_term="",d.style.display="none",d.innerHTML="")}))}let u=search_products_inputs[0],_=0,m="";const g=["Качели","Парклеты","Скамейки","Перголы","Кашпо","Шары","Столы"];let f=0;const y=300;function pl_products_input_placeholder(){m+=g[f].charAt(_),u.setAttribute("placeholder","Например: "+m),_++,g[f].length+10<_&&(_=0,m="",f++,g.length<=f&&(f=0)),setTimeout(pl_products_input_placeholder,y)}pl_products_input_placeholder()}